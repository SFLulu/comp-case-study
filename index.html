<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Compensation Case Study Allocator</title>

  <style>
    /* =========================
       GLOBAL FONT
    ========================== */
    :root{
      --border:#ddd;
      --border2:#eee;
      --text:#000;
      --muted:#555;
      --danger:#b00020;
      --bg:#fff;
      --card:#fff;
      --radius:12px;
      --pad:14px;
      --tap:44px;
    }

    body{
      font-family: "Arial Nova", Arial, Helvetica, system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 0;
      background: var(--bg);
      color: var(--text);
    }

    .wrap{
      max-width: 1100px;
      margin: 0 auto;
      padding: 12px;
      box-sizing: border-box;
    }

    .card{
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: var(--pad);
      background: var(--card);
    }

    .big{
      font-size: 20px;
      font-weight: 700;
      margin: 0 0 6px 0;
      line-height: 1.2;
    }

    .muted{
      color: var(--muted);
      font-size: 13px;
      line-height: 1.35;
    }

    .tot{
      font-weight: 700;
      margin-top: 2px;
      font-size: 20px;
      line-height: 1.1;
    }

    /* =========================
       POTS
    ========================== */
    .pots{
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin: 12px 0 12px 0;
    }

    .potLabel{
      font-size: 14px;
      font-weight: 800;
      margin-bottom: 6px;
      color: #333;
    }

    .potCard .tot{ font-size: 26px; }

    /* =========================
       BUTTONS (tap-friendly)
    ========================== */
    .btn{
      min-height: var(--tap);
      padding: 8px 12px;
      border: 1px solid #cfcfcf;
      border-radius: 10px;
      background: #fff;
      cursor: pointer;
      font-size: 15px;
      font-family: inherit;
      line-height: 1;
    }

    .btn:disabled{
      opacity: .35;
      cursor: not-allowed;
    }

    .btns{
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 8px;
    }

    .footer{
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 12px;
      flex-wrap: wrap;
    }

    .warn{
      color: var(--danger);
      font-size: 12px;
    }

    /* =========================
       EMPLOYEE META
    ========================== */
    .rowTitle{
      font-weight: 800;
      margin-bottom: 2px;
      font-size: 16px;
    }

    .meta{
      margin-top: 6px;
      font-size: 12px;
      line-height: 1.35;
    }

    .meta .label{ color: var(--muted); }
    .meta .value{ font-weight: 800; color: var(--text); }
    .meta .note{ color: var(--muted); font-style: italic; margin-top: 4px; }

    .rangeNote{
      margin-top: 8px;
      font-size: 12px;
      color: var(--text);
      font-style: italic;
    }

    /* =========================
       RESPONSIVE TABLE AREA
       (Scroll inside widget)
    ========================== */
    .tableCard{
      padding: 0;
      overflow: hidden;
    }

    .tableHeaderPad{
      padding: var(--pad);
      border-bottom: 1px solid var(--border2);
    }

    .tableScroll{
      max-height: 520px;        /* Desktop default; changes on mobile below */
      overflow: auto;
      -webkit-overflow-scrolling: touch;
    }

    table{
      width: 100%;
      border-collapse: collapse;
    }

    th, td{
      border-bottom: 1px solid var(--border2);
      padding: 10px 12px;
      vertical-align: top;
    }

    th{
      text-align: left;
      font-size: 13px;
      font-weight: 800;
      color: #444;
      background: #fff;
      position: sticky;   /* keeps header visible while scrolling */
      top: 0;
      z-index: 2;
    }

    /* =========================
       MOBILE LAYOUT
       Replace table with stacked “cards”
    ========================== */
    .mobileOnly{ display:none; }
    .desktopOnly{ display:block; }

    .empCard{
      border-bottom: 1px solid var(--border2);
      padding: 12px;
    }

    .empCard:last-child{ border-bottom: none; }

    .empTop{
      display: grid;
      grid-template-columns: 1fr;
      gap: 8px;
    }

    .empGrid{
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
      margin-top: 8px;
    }

    .subCard{
      border: 1px solid var(--border2);
      border-radius: 12px;
      padding: 10px;
      background: #fff;
    }

    .subLabel{
      font-size: 13px;
      font-weight: 800;
      margin-bottom: 6px;
      color: #333;
    }

    .allocNum{
      font-weight: 900;
      font-size: 22px;
      margin-top: 2px;
    }

    .contextLine{
      margin-top: 4px;
      font-size: 13px;
      color: var(--muted);
      line-height: 1.35;
    }

    .contextLine b{ color: var(--text); }

    details.summaryBox{
      margin-top: 8px;
      border: 1px solid var(--border2);
      border-radius: 12px;
      padding: 10px;
      background: #fff;
    }

    details.summaryBox > summary{
      cursor: pointer;
      font-weight: 800;
      color: #333;
      list-style: none;
      outline: none;
    }

    details.summaryBox > summary::-webkit-details-marker{ display:none; }

    /* =========================
       ERROR BOX
    ========================== */
    #fatalErrorBox{
      display:none;
      border: 2px solid var(--danger);
      background: #fff5f5;
      border-radius: var(--radius);
      padding: 12px;
      margin: 12px 0;
    }

    #fatalErrorBox .title{
      font-weight: 900;
      color: var(--danger);
      margin-bottom: 6px;
    }

    #fatalErrorBox pre{
      white-space: pre-wrap;
      font-size: 12px;
      margin: 8px 0 0 0;
    }

    /* =========================
       BREAKPOINTS
    ========================== */
    @media (max-width: 860px){
      .pots{ grid-template-columns: 1fr; }
      .potCard .tot{ font-size: 24px; }
      .tableScroll{ max-height: 520px; }
    }

    @media (max-width: 640px){
      .desktopOnly{ display:none; }
      .mobileOnly{ display:block; }
      .wrap{ padding: 10px; }
      .big{ font-size: 18px; }

      /* Make internal scroll area shorter so it fits inside Genially on phones */
      .tableScroll{ max-height: 420px; }
      .btn{ width: 100%; justify-content: center; }
      .btns{ gap: 8px; }
      .tot{ font-size: 22px; }
    }
  </style>
</head>

<body>
<div class="wrap">

  <!-- ERROR BOX -->
  <div id="fatalErrorBox">
    <div class="title">Something broke in the allocator (JavaScript error)</div>
    <div class="muted">Copy the error text below and paste it back to troubleshoot.</div>
    <pre id="fatalErrorText"></pre>
  </div>

  <!-- INSTRUCTIONS -->
  <div class="card">
    <div class="big">Allocate funds to your team</div>
    <div class="muted">
      Use the +$500 / –$500 buttons to allocate merit and bonus funds to your employees. Totals update automatically.
      You do not need to use your entire merit or bonus budgets. Once you’re complete, click on the employee cards
      to compare your budget with the recommended answers.
    </div>
  </div>

  <!-- POTS -->
  <div class="pots">
    <div class="card potCard">
      <div class="potLabel">Merit pot remaining</div>
      <div id="meritRemaining" class="tot">$0</div>
      <div class="muted">Allocations must be in $500 increments.</div>
    </div>

    <div class="card potCard">
      <div class="potLabel">Bonus pot remaining</div>
      <div id="bonusRemaining" class="tot">$0</div>
      <div class="muted">Allocations must be in $500 increments.</div>
    </div>
  </div>

  <!-- TABLE AREA (Desktop table + Mobile cards share same data) -->
  <div class="card tableCard">
    <div class="tableHeaderPad">
      <div class="footer" style="margin:0;">
        <button class="btn" id="resetBtn">Reset allocations</button>
        <span class="warn" id="warning"></span>
      </div>
    </div>

    <div class="tableScroll">

      <!-- DESKTOP TABLE -->
      <div class="desktopOnly">
        <table>
          <thead>
            <tr>
              <th style="width:32%;">Employee</th>
              <th style="width:28%;">Context</th>
              <th style="width:20%;">Merit</th>
              <th style="width:20%;">Bonus</th>
            </tr>
          </thead>
          <tbody id="rowsDesktop"></tbody>
        </table>
      </div>

      <!-- MOBILE STACKED CARDS -->
      <div class="mobileOnly" id="rowsMobile"></div>

    </div>
  </div>

</div>

<script>
(() => {
  "use strict";

  function showFatalError(err){
    const box = document.getElementById("fatalErrorBox");
    const text = document.getElementById("fatalErrorText");
    box.style.display = "block";
    text.textContent = err && err.stack ? err.stack : String(err);
  }

  try {
    const DENOMINATION = 500;
    const START_MERIT = 13500;
    const START_BONUS = 32000;

    const budgetRanges = {
      Ines:   { merit: [2000, 4000], bonus: [4000, 5500] },
      Ananya: { merit: [1000, 3000], bonus: [3500, 5500] },
      Jace:   { merit: [1500, 3000], bonus: [4500, 5500] },
      Miles:  { merit: [0, 2000],    bonus: [0, 6500] },
      Emilio: { merit: [0, 1000],    bonus: [0, 2500] }
    };

    const employees = [
      { empName:"Ines",   title:"Business Analyst",     basePay:70000,  performanceRating:"Exceptional", payRelative:"Competitive", notes:"Filled in for maternity leave", merit:0, bonus:0 },
      { empName:"Ananya", title:"Sr Business Analyst",  basePay:80000,  performanceRating:"Successful",  payRelative:"Low",         notes:"",                           merit:0, bonus:0 },
      { empName:"Jace",   title:"Sr Business Analyst",  basePay:85000,  performanceRating:"Successful",  payRelative:"Competitive", notes:"",                           merit:0, bonus:0 },
      { empName:"Miles",  title:"Business Manager",     basePay:130000, performanceRating:"Improve",     payRelative:"Competitive", notes:"",                           merit:0, bonus:0 },
      { empName:"Emilio", title:"Business Analyst",     basePay:80000,  performanceRating:"Improve",     payRelative:"High",        notes:"",                           merit:0, bonus:0 }
    ];

    let meritRemaining = START_MERIT;
    let bonusRemaining = START_BONUS;

    const fmt = n => n.toLocaleString("en-US", { style:"currency", currency:"USD", maximumFractionDigits:0 });

    const elMeritRemaining = document.getElementById("meritRemaining");
    const elBonusRemaining = document.getElementById("bonusRemaining");
    const elRowsDesktop = document.getElementById("rowsDesktop");
    const elRowsMobile = document.getElementById("rowsMobile");
    const elResetBtn = document.getElementById("resetBtn");
    const elWarning = document.getElementById("warning");

    function setWarning(msg){ elWarning.textContent = msg || ""; }

    function renderDesktop(){
      elRowsDesktop.innerHTML = "";
      employees.forEach((e,i)=>{
        const r = budgetRanges[e.empName];

        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>
            <div class="rowTitle">${e.empName}</div>
            <div class="muted">${e.title}</div>
            <div class="meta"><span class="label">Performance Rating:</span> <span class="value">${e.performanceRating}</span></div>
          </td>

          <td>
            <div class="muted">Base pay</div>
            <div class="tot">${fmt(e.basePay)}</div>
            <div class="meta">
              <span class="label">Pay Relative to Others:</span> <span class="value">${e.payRelative}</span>
              ${e.notes ? `<div class="note">${e.notes}</div>` : ``}
            </div>
          </td>

          <td>
            <div class="muted">Allocated</div>
            <div class="tot">${fmt(e.merit)}</div>
            <div class="btns">
              <button class="btn" ${meritRemaining < DENOMINATION ? "disabled":""} data-merit="+" data-i="${i}">+ $500</button>
              <button class="btn" ${e.merit < DENOMINATION ? "disabled":""} data-merit="-" data-i="${i}">– $500</button>
            </div>
            <div class="rangeNote">Merit Budget Range: ${fmt(r.merit[0])}-${fmt(r.merit[1])}</div>
          </td>

          <td>
            <div class="muted">Allocated</div>
            <div class="tot">${fmt(e.bonus)}</div>
            <div class="btns">
              <button class="btn" ${bonusRemaining < DENOMINATION ? "disabled":""} data-bonus="+" data-i="${i}">+ $500</button>
              <button class="btn" ${e.bonus < DENOMINATION ? "disabled":""} data-bonus="-" data-i="${i}">– $500</button>
            </div>
            <div class="rangeNote">Bonus Budget Range: ${fmt(r.bonus[0])}-${fmt(r.bonus[1])}</div>
          </td>
        `;
        elRowsDesktop.appendChild(tr);
      });
    }

    function renderMobile(){
      elRowsMobile.innerHTML = "";
      employees.forEach((e,i)=>{
        const r = budgetRanges[e.empName];

        const card = document.createElement("div");
        card.className = "empCard";

        card.innerHTML = `
          <div class="empTop">
            <div>
              <div class="rowTitle">${e.empName}</div>
              <div class="muted">${e.title}</div>
              <div class="meta"><span class="label">Performance Rating:</span> <span class="value">${e.performanceRating}</span></div>

              <details class="summaryBox">
                <summary>View context</summary>
                <div class="contextLine">Base pay: <b>${fmt(e.basePay)}</b></div>
                <div class="contextLine">Pay Relative to Others: <b>${e.payRelative}</b></div>
                ${e.notes ? `<div class="contextLine" style="font-style:italic;">${e.notes}</div>` : ``}
              </details>
            </div>
          </div>

          <div class="empGrid">
            <div class="subCard">
              <div class="subLabel">Merit</div>
              <div class="muted">Allocated</div>
              <div class="allocNum">${fmt(e.merit)}</div>
              <div class="btns">
                <button class="btn" ${meritRemaining < DENOMINATION ? "disabled":""} data-merit="+" data-i="${i}">+ $500</button>
                <button class="btn" ${e.merit < DENOMINATION ? "disabled":""} data-merit="-" data-i="${i}">– $500</button>
              </div>
              <div class="rangeNote">Merit Budget Range: ${fmt(r.merit[0])}-${fmt(r.merit[1])}</div>
            </div>

            <div class="subCard">
              <div class="subLabel">Bonus</div>
              <div class="muted">Allocated</div>
              <div class="allocNum">${fmt(e.bonus)}</div>
              <div class="btns">
                <button class="btn" ${bonusRemaining < DENOMINATION ? "disabled":""} data-bonus="+" data-i="${i}">+ $500</button>
                <button class="btn" ${e.bonus < DENOMINATION ? "disabled":""} data-bonus="-" data-i="${i}">– $500</button>
              </div>
              <div class="rangeNote">Bonus Budget Range: ${fmt(r.bonus[0])}-${fmt(r.bonus[1])}</div>
            </div>
          </div>
        `;
        elRowsMobile.appendChild(card);
      });
    }

    function render(){
      elMeritRemaining.textContent = fmt(meritRemaining);
      elBonusRemaining.textContent = fmt(bonusRemaining);
      renderDesktop();
      renderMobile();
    }

    function applyDelta(i, type, delta){
      setWarning("");

      if(type === "merit"){
        if(delta > 0 && meritRemaining < delta) return setWarning("Merit pot is empty.");
        if(delta < 0 && employees[i].merit < (-delta)) return;
        employees[i].merit += delta;
        meritRemaining -= delta;
      }

      if(type === "bonus"){
        if(delta > 0 && bonusRemaining < delta) return setWarning("Bonus pot is empty.");
        if(delta < 0 && employees[i].bonus < (-delta)) return;
        employees[i].bonus += delta;
        bonusRemaining -= delta;
      }

      render();
    }

    document.addEventListener("click",(ev)=>{
      const btn = ev.target.closest("button");
      if(!btn) return;

      const i = Number(btn.dataset.i);
      if(Number.isNaN(i)) return;

      if(btn.dataset.merit){
        const delta = (btn.dataset.merit === "+") ? DENOMINATION : -DENOMINATION;
        applyDelta(i, "merit", delta);
      }

      if(btn.dataset.bonus){
        const delta = (btn.dataset.bonus === "+") ? DENOMINATION : -DENOMINATION;
        applyDelta(i, "bonus", delta);
      }
    });

    elResetBtn.addEventListener("click",()=>{
      employees.forEach(e=>{ e.merit=0; e.bonus=0; });
      meritRemaining = START_MERIT;
      bonusRemaining = START_BONUS;
      setWarning("");
      render();
    });

    render();

  } catch(err){
    showFatalError(err);
  }
})();
</script>

</body>
</html>
